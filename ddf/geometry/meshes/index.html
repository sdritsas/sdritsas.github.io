
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Stylianos Dritsas">
      
      
      
        <link rel="prev" href="../surfaces/computational/">
      
      
        <link rel="next" href="topology/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.40">
    
    
      
        <title>Geometry - Digital Design and Fabrication</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.8c3ca2c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      

  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 22c5.5 0 10-4.5 10-10S17.5 2 12 2 2 6.5 2 12s4.5 10 10 10M11 7h2v2h-2zm3 10h-4v-2h1v-2h-1v-2h3v4h1z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/style.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mesh-geometry" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Digital Design and Fabrication" class="md-header__button md-logo" aria-label="Digital Design and Fabrication" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 2 4 4h-3v7.85l6.53 3.76L21 15.03l1.5 5.47-5.5 1.46 1.53-2.61L12 15.58l-6.53 3.77L7 21.96 1.5 20.5 3 15.03l1.47 2.58L11 13.85V6H8z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Digital Design and Fabrication
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Geometry
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Digital Design and Fabrication" class="md-nav__button md-logo" aria-label="Digital Design and Fabrication" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12 2 4 4h-3v7.85l6.53 3.76L21 15.03l1.5 5.47-5.5 1.46 1.53-2.61L12 15.58l-6.53 3.77L7 21.96 1.5 20.5 3 15.03l1.47 2.58L11 13.85V6H8z"/></svg>

    </a>
    Digital Design and Fabrication
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Parametrics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Parametrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parametrics/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parametrics/template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../parametrics/cpython/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPython
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programming
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/collections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/functions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../programming/objects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Objects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Geometry
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Vectors
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Vectors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/distances/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Distance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/addition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Addition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/subtraction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Subtraction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/multiplication/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiplication
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/normalize/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Normalization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/dot-product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dot Product
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/cross-product/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cross Product
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/systems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Coordinate Systems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../vectors/transforms/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Curves
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Curves
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../curves/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../curves/euclidean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Euclidean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../curves/computational/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computational
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Surfaces
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Surfaces
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surfaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surfaces/euclidean/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Euclidean
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../surfaces/computational/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computational
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Meshes
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Meshes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Geometry
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#representations" class="md-nav__link">
    <span class="md-ellipsis">
      Representations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Representations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#triangle-lists" class="md-nav__link">
    <span class="md-ellipsis">
      Triangle Lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Meshes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversions" class="md-nav__link">
    <span class="md-ellipsis">
      Conversions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-normals" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Normals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mesh Normals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#face-winding" class="md-nav__link">
    <span class="md-ellipsis">
      Face Winding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-shading" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Shading
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-colors" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Colors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-textures" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Textures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#barycentrics" class="md-nav__link">
    <span class="md-ellipsis">
      Barycentrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#surface-area" class="md-nav__link">
    <span class="md-ellipsis">
      Surface Area
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesh-volume" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deduplication" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="topology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Topology
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Solids
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Solids
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solids/constructive/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Constructive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solids/boundary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Boundary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solids/voxels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Volumetric
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solids/clouds/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Point Clouds
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Constructions
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Constructions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/angles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Angles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/areas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Areas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/centroids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Centroids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/clashes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clashes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/containment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/mappings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mappings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/offsets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Offsets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/perpendiculars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perpendiculars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/polygons/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polygons
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/projections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Projections
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../constructions/reflections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reflections
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#representations" class="md-nav__link">
    <span class="md-ellipsis">
      Representations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Representations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#triangle-lists" class="md-nav__link">
    <span class="md-ellipsis">
      Triangle Lists
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#indexed-meshes" class="md-nav__link">
    <span class="md-ellipsis">
      Indexed Meshes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conversions" class="md-nav__link">
    <span class="md-ellipsis">
      Conversions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-normals" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Normals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mesh Normals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#face-winding" class="md-nav__link">
    <span class="md-ellipsis">
      Face Winding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-shading" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Shading
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-colors" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Colors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mesh-textures" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Textures
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#barycentrics" class="md-nav__link">
    <span class="md-ellipsis">
      Barycentrics
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#surface-area" class="md-nav__link">
    <span class="md-ellipsis">
      Surface Area
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mesh-volume" class="md-nav__link">
    <span class="md-ellipsis">
      Mesh Volume
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deduplication" class="md-nav__link">
    <span class="md-ellipsis">
      Deduplication
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="mesh-geometry">Mesh Geometry</h1>
<p>Meshes are collections of simple polygons, typically triangles or quads, used for representing surfaces and solids. They are are motivated by their capability for accelerated processing via GPUs and for overcoming the limitations of mathematical surfaces which require well-behaved functions in the sense of continuity and derivatives.</p>
<h2 id="representations">Representations</h2>
<h3 id="triangle-lists">Triangle Lists</h3>
<p>The simplest way to define a mesh is via a collection of 3D points, every three thereof describing a triangle. A table <code>( n, 3 )</code> of points <code>M = [[a1, b1, c1], ... [an, bn, cn]]</code> is often used, however, it is also common to use a <code>( n, 3, 3 )</code> tensors in <code>numpy</code> and <code>pytorch</code> or flat lists of  <code>( n * 9 )</code> coordinates when uploading the data to the GPU.</p>
<div class="highlight"><pre><span></span><code><span id="__span-0-1"><span class="k">class</span><span class="w"> </span><span class="nc">TriangleList</span><span class="p">:</span>
</span><span id="__span-0-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">triangles</span> <span class="p">):</span>
</span><span id="__span-0-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span> <span class="o">=</span> <span class="n">triangles</span>
</span><span id="__span-0-4">
</span><span id="__span-0-5">    <span class="k">def</span><span class="w"> </span><span class="nf">ToFloats</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-0-6">        <span class="n">coordinates</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-7">        <span class="k">for</span> <span class="n">triangle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span><span class="p">:</span>
</span><span id="__span-0-8">            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">triangle</span><span class="p">:</span>
</span><span id="__span-0-9">                <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">point</span><span class="o">.</span><span class="n">X</span> <span class="p">)</span>
</span><span id="__span-0-10">                <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">point</span><span class="o">.</span><span class="n">Y</span> <span class="p">)</span>
</span><span id="__span-0-11">                <span class="n">coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span>
</span><span id="__span-0-12">        <span class="k">return</span> <span class="n">coordinates</span>
</span><span id="__span-0-13">
</span><span id="__span-0-14">    <span class="k">def</span><span class="w"> </span><span class="nf">ToNumPy</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-0-15">        <span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span> <span class="p">),</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span> <span class="p">)</span> <span class="p">)</span>
</span><span id="__span-0-16">        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">triangle</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span> <span class="p">):</span>
</span><span id="__span-0-17">            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">triangle</span> <span class="p">):</span>
</span><span id="__span-0-18">                <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">X</span>
</span><span id="__span-0-19">                <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">Y</span>
</span><span id="__span-0-20">                <span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span>
</span><span id="__span-0-21">        <span class="k">return</span> <span class="n">array</span>
</span><span id="__span-0-22">
</span><span id="__span-0-23"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">TriangleList</span><span class="p">(</span> <span class="p">[</span>
</span><span id="__span-0-24">    <span class="p">[</span><span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-0-25">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-0-26">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)],</span>
</span><span id="__span-0-27">
</span><span id="__span-0-28">    <span class="p">[</span><span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-0-29">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-0-30">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)]]</span> <span class="p">)</span>
</span></code></pre></div>
<p>This representation is the most unstructured way to describe meshes also known as a soup of triangles. It is used when each point is associated with a unique color <code>[r, g, b, a]</code> or a texture coordinate <code>[u, v]</code>. Otherwise, it is considered wasteful because often triangles share points which are duplicated here. For instance a cube has <code>8</code> vertices and <code>6 * 2 = 12</code> triangles, but with this representation we need <code>12 * 3 = 36</code> vertices! Note that this definition may be trivially extended to include quads or polygons instead of only triangles.</p>
<h3 id="indexed-meshes">Indexed Meshes</h3>
<p>The common way to represent meshes is using a list of points <code>P = [P0, P1, ..., Pn-1]</code>, also known as vertices, and a list of  indices <code>F = [F0, F1, ..., Fn-1]</code>, also known as faces. A face <code>F[i]</code> is a just list of integers <code>[a, b, c]</code>, where <code>a</code>, <code>b</code> and <code>c</code> describe which vertices to select from the vertex-list, by index, to form a triangle, namely <code>P[a]</code>, <code>P[b]</code> and <code>P[c]</code>. For example, the face <code>[4, 1, 6]</code> represents a triangle with points <code>P[4]</code>, <code>P[1]</code>, and <code>P[6]</code>. The motivation for this representation is primarily for saving memory. A cube only requires <code>8</code> vertices as opposed to <code>36</code> with the equivalent triangle soup representation.</p>
<div class="highlight"><pre><span></span><code><span id="__span-1-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-1-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">):</span>
</span><span id="__span-1-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-1-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">indices</span>
</span><span id="__span-1-5">
</span><span id="__span-1-6"><span class="w">    </span><span class="sd">&#39;&#39;&#39; Face Index -&gt; Points</span>
</span><span id="__span-1-7"><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-1-8">    <span class="k">def</span><span class="w"> </span><span class="nf">TriangleAt</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">face</span> <span class="p">):</span>
</span><span id="__span-1-9">        <span class="n">ia</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ic</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span><span class="p">[</span><span class="n">face</span><span class="p">]</span>
</span><span id="__span-1-10">
</span><span id="__span-1-11">        <span class="n">pa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ia</span><span class="p">]</span>
</span><span id="__span-1-12">        <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ib</span><span class="p">]</span>
</span><span id="__span-1-13">        <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
</span><span id="__span-1-14">
</span><span id="__span-1-15">        <span class="k">return</span> <span class="p">[</span><span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pc</span><span class="p">]</span>
</span><span id="__span-1-16">
</span><span id="__span-1-17"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">IndexedMesh</span><span class="p">(</span>
</span><span id="__span-1-18">    <span class="p">[</span><span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-1-19">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-1-20">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-1-21">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)],</span>
</span><span id="__span-1-22">
</span><span id="__span-1-23">    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>
</span></code></pre></div>
<p>Rhino's meshes are based on the latter representation. The collection of points is accessed via the <code>Vertices</code> property and the triangulation indices via the <code>Faces</code> property. Note that Rhino supports mixed meshes containing not only triangles but also quads simultaneously. Newer versions also allow meshes with polygonal faces.</p>
<div class="highlight"><pre><span></span><code><span id="__span-2-1"><span class="sd">&quot;&quot;&quot; Mesh Construction</span>
</span><span id="__span-2-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-2-3"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">Mesh</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-2-4">
</span><span id="__span-2-5"><span class="n">a</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-2-6"><span class="n">b</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-2-7"><span class="n">c</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-2-8"><span class="n">d</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-2-9">
</span><span id="__span-2-10"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">)</span>
</span><span id="__span-2-11"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span>
</span><span id="__span-2-12">
</span><span id="__span-2-13"><span class="sd">&#39;&#39;&#39; add quadrilateral &#39;&#39;&#39;</span>
</span><span id="__span-2-14">
</span><span id="__span-2-15"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span> <span class="p">)</span>
</span></code></pre></div>
<p>Note that mesh points in Rhino are represented by <code>Point3f</code> using single precision floating point numbers instead of <code>Point3d</code> which use doubles. This is because graphics cards work faster with lower precision values. Nevertheless, <code>Point3f</code> does not implement the range of methods <code>Point3d</code> does, thus for performing computations conversion is required.</p>
<div class="highlight"><pre><span></span><code><span id="__span-3-1"><span class="sd">&quot;&quot;&quot; Retrieve Mesh Vertex</span>
</span><span id="__span-3-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-3"><span class="n">vertex</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-3-4">
</span><span id="__span-3-5"><span class="sd">&quot;&quot;&quot; Convert to Point3d</span>
</span><span id="__span-3-6"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-7"><span class="n">point</span> <span class="o">=</span> <span class="ne">Point3d</span><span class="p">(</span> <span class="n">vertex</span> <span class="p">)</span>
</span><span id="__span-3-8">
</span><span id="__span-3-9"><span class="sd">&quot;&quot;&quot; Perform Computation</span>
</span><span id="__span-3-10"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-11"><span class="n">point</span> <span class="o">+=</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">ZAxis</span>
</span><span id="__span-3-12">
</span><span id="__span-3-13"><span class="sd">&quot;&quot;&quot; Convert to Point3f</span>
</span><span id="__span-3-14"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-3-15"><span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="ne">Point3f</span><span class="p">(</span> <span class="n">point</span><span class="o">.</span><span class="n">X</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span>
</span><span id="__span-3-16">
</span><span id="__span-3-17"><span class="sd">&#39;&#39;&#39; equivalent &#39;&#39;&#39;</span>
</span><span id="__span-3-18">
</span><span id="__span-3-19"><span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">SetVertex</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">point</span> <span class="p">)</span>
</span></code></pre></div>
<h3 id="conversions">Conversions</h3>
<p>Converting between indexed meshes and triangle lists is straight forward application of the indexing logic to select the appropriate vertices and package them into a list.</p>
<div class="highlight"><pre><span></span><code><span id="__span-4-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-4-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">):</span>
</span><span id="__span-4-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-4-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">indices</span>
</span><span id="__span-4-5">
</span><span id="__span-4-6">    <span class="k">def</span><span class="w"> </span><span class="nf">ToTriangleList</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-4-7">        <span class="n">triangles</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">TriangleAt</span><span class="p">(</span> <span class="n">index</span> <span class="p">)</span>
</span><span id="__span-4-8">            <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span> <span class="p">)</span> <span class="p">)]</span>
</span><span id="__span-4-9">        <span class="k">return</span> <span class="ne">TriangleList</span><span class="p">(</span> <span class="n">triangles</span> <span class="p">)</span>
</span></code></pre></div>
<p>The opposite conversion, from a triangle list to an indexed mesh, requires flattening all triangles into a list of vertices and serially numbering the faces <code>[0, 1, 2], [3, 4, 5] ...</code>. Note that this process will not merge duplicate vertices and provide a compact the triangle soup.</p>
<div class="highlight"><pre><span></span><code><span id="__span-5-1"><span class="k">class</span><span class="w"> </span><span class="nc">TriangleList</span><span class="p">:</span>
</span><span id="__span-5-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">triangles</span> <span class="p">):</span>
</span><span id="__span-5-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span> <span class="o">=</span> <span class="n">triangles</span>
</span><span id="__span-5-4">
</span><span id="__span-5-5">    <span class="k">def</span><span class="w"> </span><span class="nf">ToIndexedMesh</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-5-6">        <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="__span-5-7">        <span class="k">for</span> <span class="n">triangle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span><span class="p">:</span>
</span><span id="__span-5-8">            <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">vertices</span> <span class="p">)</span>
</span><span id="__span-5-9">            <span class="n">faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">index</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-5-10">                           <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-5-11">                           <span class="n">index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-5-12">            <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">triangle</span><span class="p">:</span>
</span><span id="__span-5-13">                <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">point</span> <span class="p">)</span>
</span><span id="__span-5-14">        <span class="k">return</span> <span class="ne">IndexedMesh</span><span class="p">(</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">)</span>
</span></code></pre></div>
<h2 id="mesh-normals">Mesh Normals</h2>
<p>The concept of mesh normals is associated with ideas presented in the analytical curves and surfaces section. Mesh normals are defined per mesh point and express the locally tangent plane. Therefore, the number of normals is the same with the number of points. Mesh normals can be assigned arbitrarily or computed in the approximate sense, since there are no surface derivatives for meshes as they are fundamentally non-differentiable.</p>
<p>This approximation is performed by averaging the plane normals from the triangles connected with each point. There are two common methods for computing mesh normals, namely weighted and unweighted. The difference is in accumulating unnormalized or normalized normals for each triangle. In other words, using the triangle's area as a weight encoded in the cross product of its sides or not. Weighted normals is motivated by the potential presence of tiny or sliver triangles which may affect the normal direction adversely.</p>
<div class="highlight"><pre><span></span><code><span id="__span-6-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-6-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">normals</span> <span class="p">):</span>
</span><span id="__span-6-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-6-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-6-5">        <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span>  <span class="o">=</span> <span class="n">normals</span>
</span><span id="__span-6-6">
</span><span id="__span-6-7">        <span class="k">if</span><span class="p">(</span> <span class="n">normals</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">):</span>
</span><span id="__span-6-8">            <span class="bp">self</span><span class="o">.</span><span class="n">ComputeNormals</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-6-9">
</span><span id="__span-6-10">    <span class="k">def</span><span class="w"> </span><span class="nf">ComputeNormals</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">weighted</span> <span class="o">=</span> <span class="kc">False</span> <span class="p">):</span>
</span><span id="__span-6-11">        <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span> <span class="o">=</span> <span class="p">[</span><span class="ne">Vector3d</span><span class="o">.</span><span class="n">Zero</span>
</span><span id="__span-6-12">            <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">]</span>
</span><span id="__span-6-13">
</span><span id="__span-6-14">        <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span><span class="p">:</span>
</span><span id="__span-6-15">            <span class="n">normal</span> <span class="o">=</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span>
</span><span id="__span-6-16">                <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">a</span><span class="p">],</span>
</span><span id="__span-6-17">                <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-6-18">            <span class="k">if</span><span class="p">(</span> <span class="ow">not</span> <span class="n">weighted</span> <span class="p">):</span> <span class="n">normal</span><span class="o">.</span><span class="n">Unitize</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-6-19">
</span><span id="__span-6-20">            <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">normal</span>
</span><span id="__span-6-21">            <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="n">normal</span>
</span><span id="__span-6-22">            <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">+=</span> <span class="n">normal</span>
</span><span id="__span-6-23">
</span><span id="__span-6-24">        <span class="k">for</span> <span class="n">normal</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span><span class="p">:</span>
</span><span id="__span-6-25">            <span class="n">normal</span><span class="o">.</span><span class="n">Unitize</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-6-26">        <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div>
<p>In Rhino mesh normals have the same semantics. They can be assigned manually or computed automatically. Note that mesh normals are <code>Vector3f</code> instead of <code>Vector3d</code>, so conversions may be required.</p>
<div class="highlight"><pre><span></span><code><span id="__span-7-1"><span class="sd">&quot;&quot;&quot; Mesh Construction</span>
</span><span id="__span-7-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-7-3"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">Mesh</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-7-4">
</span><span id="__span-7-5"><span class="n">a</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-7-6"><span class="n">b</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-7-7"><span class="n">c</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-7-8"><span class="n">d</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-7-9">
</span><span id="__span-7-10"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">)</span>
</span><span id="__span-7-11"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span>
</span><span id="__span-7-12">
</span><span id="__span-7-13"><span class="sd">&#39;&#39;&#39; manually &#39;&#39;&#39;</span>
</span><span id="__span-7-14"><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Count</span> <span class="p">):</span>
</span><span id="__span-7-15">    <span class="n">mesh</span><span class="o">.</span><span class="n">Normals</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">ZAxis</span> <span class="p">)</span>
</span><span id="__span-7-16">
</span><span id="__span-7-17"><span class="sd">&#39;&#39;&#39; computed &#39;&#39;&#39;</span>
</span><span id="__span-7-18">
</span><span id="__span-7-19"><span class="n">mesh</span><span class="o">.</span><span class="n">Normals</span><span class="o">.</span><span class="n">ComputeNormals</span><span class="p">(</span> <span class="p">)</span>
</span></code></pre></div>
<h3 id="face-winding">Face Winding</h3>
<p>The order by which triangle points are used to define their normals is important because the cross product is not commutative. This implies that a triangle <code>[a, b, c]</code> will have its normal flipped if we use <code>[a, c, b]</code>. Meshes with inconsistent triangle winding can cause problems from visualization to 3d printing because mesh normals are used for lighting, hidden surface removal and solid closure determination.</p>
<div class="highlight"><pre><span></span><code><span id="__span-8-1"><span class="sd">&quot;&quot;&quot; Inconsistent Winding</span>
</span><span id="__span-8-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-8-3"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">IndexedMesh</span><span class="p">(</span>
</span><span id="__span-8-4">    <span class="p">[</span><span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-8-5">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-8-6">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-8-7">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)],</span>
</span><span id="__span-8-8">
</span><span id="__span-8-9">    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span> <span class="p">)</span> <span class="c1">#-- vs. [2, 3, 0]</span>
</span></code></pre></div>
<h3 id="flat-shading">Flat Shading</h3>
<p>Mesh normals are used for smoothly shading triangles against light sources. However, a box expressed as an indexed mesh with <code>8</code> vertices and <code>12</code> triangles arguably looks weird. This is because the normals are averaged across faces with sharp angles.</p>
<p>To avoid this artifact and/or in general to force a mesh to appear with each triangle flat shaded the following approach can be used. The method below copies every triangle but the points are duplicated or unshared such that the normals will not wrap around corners.</p>
<div class="highlight"><pre><span></span><code><span id="__span-9-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-9-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">normals</span> <span class="p">):</span>
</span><span id="__span-9-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span>  <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-9-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>     <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-9-5">        <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span>   <span class="o">=</span> <span class="n">normals</span>
</span><span id="__span-9-6">        <span class="k">if</span><span class="p">(</span> <span class="n">normals</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">):</span>
</span><span id="__span-9-7">            <span class="bp">self</span><span class="o">.</span><span class="n">ComputeNormals</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-9-8">
</span><span id="__span-9-9">    <span class="k">def</span><span class="w"> </span><span class="nf">ToFlatMesh</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-9-10">        <span class="n">points</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-9-11">        <span class="n">planes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-9-12">        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span> <span class="p">):</span>
</span><span id="__span-9-13">            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-9-14">            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-9-15">            <span class="n">points</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-9-16">            <span class="n">planes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="__span-9-17">                            <span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-9-18">                            <span class="n">index</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-9-19">        <span class="k">return</span> <span class="ne">IndexedMesh</span><span class="p">(</span> <span class="n">points</span><span class="p">,</span> <span class="n">planes</span> <span class="p">)</span>
</span></code></pre></div>
<h2 id="mesh-colors">Mesh Colors</h2>
<p>Assigning colors to mesh vertices is common from old-school video games to 3d printing and scientific visualization. Supporting per vertex colors is usually implemented with a list containing as many colors as the number of points. Colors may be encoded as either RGB <code>[r, g, b]</code> or RGBA <code>[r, g, b, a]</code> values, where the color components <code>r</code>, <code>g</code>, <code>b</code> and <code>a</code>,  are either expressed as bytes <code>[0, 255]</code> or floats in <code>[0.0, 1.0]</code>.</p>
<div class="highlight"><pre><span></span><code><span id="__span-10-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-10-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">normals</span> <span class="p">):</span>
</span><span id="__span-10-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span>  <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-10-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>     <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-10-5">        <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span>   <span class="o">=</span> <span class="n">normals</span>
</span><span id="__span-10-6">        <span class="bp">self</span><span class="o">.</span><span class="n">Colors</span>    <span class="o">=</span> <span class="n">colors</span>
</span><span id="__span-10-7">
</span><span id="__span-10-8">    <span class="k">def</span><span class="w"> </span><span class="nf">PaintNormals</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-10-9">        <span class="bp">self</span><span class="o">.</span><span class="n">Colors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-10-10">        <span class="k">for</span> <span class="n">normal</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Normals</span><span class="p">:</span>
</span><span id="__span-10-11"><span class="w">            </span><span class="sd">&#39;&#39;&#39; Float RGB values [0, 1]</span>
</span><span id="__span-10-12"><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="__span-10-13">            <span class="n">r</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">normal</span><span class="o">.</span><span class="n">X</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-10-14">            <span class="n">g</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">normal</span><span class="o">.</span><span class="n">Y</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-10-15">            <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">normal</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>
</span><span id="__span-10-16">
</span><span id="__span-10-17"><span class="w">            </span><span class="sd">&#39;&#39;&#39; Byte RGB values [0, 255]</span>
</span><span id="__span-10-18"><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="__span-10-19">            <span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">r</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span><span id="__span-10-20">            <span class="n">g</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">g</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span><span id="__span-10-21">            <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">b</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span><span id="__span-10-22">
</span><span id="__span-10-23">            <span class="bp">self</span><span class="o">.</span><span class="n">Colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">r</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-10-24">        <span class="k">return</span> <span class="bp">self</span>
</span><span id="__span-10-25">
</span><span id="__span-10-26">    <span class="k">def</span><span class="w"> </span><span class="nf">PaintZ</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-10-27"><span class="w">        </span><span class="sd">&#39;&#39;&#39; Min and Max Z-coordinates</span>
</span><span id="__span-10-28"><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-10-29">        <span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span> <span class="o">=</span> <span class="mf">1e10</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e10</span>
</span><span id="__span-10-30">        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">:</span>
</span><span id="__span-10-31">            <span class="n">zmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span> <span class="n">zmin</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span>
</span><span id="__span-10-32">            <span class="n">zmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span> <span class="n">zmax</span><span class="p">,</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span>
</span><span id="__span-10-33">        <span class="n">dz</span> <span class="o">=</span> <span class="n">zmax</span> <span class="o">-</span> <span class="n">zmin</span>
</span><span id="__span-10-34">        <span class="n">dz</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="k">if</span><span class="p">(</span> <span class="n">dz</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="p">)</span> <span class="k">else</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">dz</span>
</span><span id="__span-10-35">
</span><span id="__span-10-36">        <span class="bp">self</span><span class="o">.</span><span class="n">Colors</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-10-37">        <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">:</span>
</span><span id="__span-10-38"><span class="w">            </span><span class="sd">&#39;&#39;&#39; Float Gray Tone</span>
</span><span id="__span-10-39"><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="__span-10-40">            <span class="n">gray</span> <span class="o">=</span> <span class="p">(</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="o">-</span> <span class="n">zmin</span> <span class="p">)</span> <span class="o">*</span> <span class="n">dz</span>
</span><span id="__span-10-41">
</span><span id="__span-10-42"><span class="w">            </span><span class="sd">&#39;&#39;&#39; Byte Gray Tone</span>
</span><span id="__span-10-43"><span class="sd">            &#39;&#39;&#39;</span>
</span><span id="__span-10-44">            <span class="n">gray</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span> <span class="mi">255</span> <span class="o">*</span> <span class="n">gray</span> <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span><span id="__span-10-45">            <span class="bp">self</span><span class="o">.</span><span class="n">Colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">[</span><span class="n">gray</span><span class="p">,</span> <span class="n">gray</span><span class="p">,</span> <span class="n">gray</span><span class="p">]</span> <span class="p">)</span>
</span><span id="__span-10-46">        <span class="k">return</span> <span class="bp">self</span>
</span></code></pre></div>
<p>Rhino uses the color format representation of <a href="https://learn.microsoft.com/en-us/dotnet/api/system.drawing.color?view=netframework-4.8.1">.NET / Windows</a> where alpha, red, green and blue are packed into a single 32-bit integer.</p>
<div class="highlight"><pre><span></span><code><span id="__span-11-1"><span class="kn">from</span><span class="w"> </span><span class="nn">System.Drawing</span><span class="w"> </span><span class="kn">import</span> <span class="ne">Color</span>
</span><span id="__span-11-2">
</span><span id="__span-11-3"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">Mesh</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-11-4">
</span><span id="__span-11-5"><span class="n">a</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-11-6"><span class="n">b</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-11-7"><span class="n">c</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-11-8"><span class="n">d</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-11-9">
</span><span id="__span-11-10"><span class="n">mesh</span><span class="o">.</span><span class="n">VertexColors</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="ne">Color</span><span class="o">.</span><span class="n">FromArbg</span><span class="p">(</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0xFF</span>       <span class="p">)</span> <span class="p">)</span> <span class="c1">#-- R, G, B</span>
</span><span id="__span-11-11"><span class="n">mesh</span><span class="o">.</span><span class="n">VertexColors</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="ne">Color</span><span class="o">.</span><span class="n">FromArbg</span><span class="p">(</span> <span class="mh">0xFF0000</span>               <span class="p">)</span> <span class="p">)</span> <span class="c1">#-- RGB</span>
</span><span id="__span-11-12"><span class="n">mesh</span><span class="o">.</span><span class="n">VertexColors</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="ne">Color</span><span class="o">.</span><span class="n">FromArbg</span><span class="p">(</span> <span class="mh">0x80</span><span class="p">,</span> <span class="mh">0x00</span><span class="p">,</span> <span class="mh">0xFF</span><span class="p">,</span> <span class="mh">0x00</span> <span class="p">)</span> <span class="p">)</span> <span class="c1">#-- A, R, G, B</span>
</span><span id="__span-11-13"><span class="n">mesh</span><span class="o">.</span><span class="n">VertexColors</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="ne">Color</span><span class="o">.</span><span class="n">FromArbg</span><span class="p">(</span> <span class="mh">0x800000FF</span>             <span class="p">)</span> <span class="p">)</span> <span class="c1">#-- ARGB</span>
</span><span id="__span-11-14">
</span><span id="__span-11-15"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">)</span>
</span><span id="__span-11-16"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span>
</span></code></pre></div>
<h2 id="mesh-textures">Mesh Textures</h2>
<p>Associating colors per vertex and letting the GPU smoothly bend them in the interior of triangles can only go as far as painting meshes with gradients. Texture mapping enables applying raster images with much more complex patterns. This is performed by associating each vertex with a texture coordinate, that is the pixel location in the image space.</p>
<p>Texture coordinates <code>u</code> and <code>v</code> for the horizontal and vertical image direction, respectively, are not expressed in pixels but in the unit range <code>[0, 1]</code>. When the letters <code>s</code> and <code>t</code> are used instead of <code>u</code> and <code>v</code>, the vertical direction of the image is flipped, that is <code>u</code> and <code>s</code> are always left-to-right but <code>u</code> is bottom-to-top while <code>t</code> is top-to-bottom, that is <code>v = 1 - t</code>.</p>
<div class="highlight"><pre><span></span><code><span id="__span-12-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-12-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span><span class="p">,</span> <span class="n">textures</span> <span class="p">):</span>
</span><span id="__span-12-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span>  <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-12-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>     <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-12-5">        <span class="bp">self</span><span class="o">.</span><span class="n">Textures</span>  <span class="o">=</span> <span class="n">textures</span>
</span><span id="__span-12-6">
</span><span id="__span-12-7"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">IndexedMesh</span><span class="p">(</span>
</span><span id="__span-12-8">    <span class="p">[</span><span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-12-9">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-12-10">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">),</span>
</span><span id="__span-12-11">     <span class="ne">Point3d</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)],</span>
</span><span id="__span-12-12">
</span><span id="__span-12-13">    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span>
</span><span id="__span-12-14">
</span><span id="__span-12-15">    <span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
</span><span id="__span-12-16">     <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
</span><span id="__span-12-17">     <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
</span><span id="__span-12-18">     <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]</span> <span class="p">)</span>
</span></code></pre></div>
<p>Rhino uses the same semantics via the <code>TextureCoordinates</code> property. Note that texture coordinates use the <code>s</code> and <code>t</code> convention and they are single precision 2D points <code>Point2f</code>.</p>
<div class="highlight"><pre><span></span><code><span id="__span-13-1"><span class="sd">&quot;&quot;&quot; Texture Coordinates</span>
</span><span id="__span-13-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-13-3"><span class="n">mesh</span> <span class="o">=</span> <span class="ne">Mesh</span><span class="p">(</span> <span class="p">)</span>
</span><span id="__span-13-4">
</span><span id="__span-13-5"><span class="n">a</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-6"><span class="n">b</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-7"><span class="n">c</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-8"><span class="n">d</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Vertices</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-9">
</span><span id="__span-13-10"><span class="n">mesh</span><span class="o">.</span><span class="n">TextureCoordinates</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-11"><span class="n">mesh</span><span class="o">.</span><span class="n">TextureCoordinates</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="p">)</span>
</span><span id="__span-13-12"><span class="n">mesh</span><span class="o">.</span><span class="n">TextureCoordinates</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">)</span>
</span><span id="__span-13-13"><span class="n">mesh</span><span class="o">.</span><span class="n">TextureCoordinates</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="p">)</span>
</span><span id="__span-13-14">
</span><span id="__span-13-15"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="p">)</span>
</span><span id="__span-13-16"><span class="n">mesh</span><span class="o">.</span><span class="n">Faces</span><span class="o">.</span><span class="n">AddFace</span><span class="p">(</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">a</span> <span class="p">)</span>
</span></code></pre></div>
<h2 id="barycentrics">Barycentrics</h2>
<p>Vertex normals and colors are interpolated by the GPU for shading the interior pixels of triangles in visually smooth way. This process is known as barycentric interpolation and aims to smoothly blend between three quantities, which may be vertices, normals, colors etc.</p>
<p>A point <code>p</code> within a triangle <code>[a, b, c]</code>, where <code>a</code>, <code>b</code> and <code>c</code> are its vertices, may be expressed as the ratio of areas of the triangles formed by <code>a</code>, <code>b</code>, <code>c</code> and <code>p</code>. The areas are computed using the convention <code>A = |p, b, c|</code>, <code>B = |p, c, a|</code> and <code>C = |p, a, b|</code>, where the area for vertex <code>a</code> involves point <code>p</code> and the opposite side of the triangle <code>bc</code>. The sum of these areas <code>A + B + C</code> equals the area of the triangle <code>T = |a, b, c|</code>, that is <code>A + B + C = T</code>. By dividing with the area of the triangle produces <code>A/T + B/T + C/T = 1</code>.</p>
<p>The terms <code>wa = A/T</code>,  <code>wb = B/T</code> and <code>wc = C/T</code> are the barycentric coordinates or the weights of the interpolation. This because we can address every point <code>p</code> in the interior of the triangle by the weighted sum of the vertices <code>p = a * wa + b * wb + c * wc</code>.  The values of the weights are in the unit range <code>[0, 1]</code>. When the weights are <code>[1, 0, 0]</code>, <code>[0, 1, 0]</code>and <code>[0, 0, 1]</code>, then the interpolated points are on the vertices <code>a</code>, <code>b</code> and <code>c</code>, respectively. Moreover, when the weights are <code>[1/3, 1/3, 1/3]</code> the interpolated point is at the centroid of the triangle <code>( a + b + c ) / 3</code>, hence the name barycentric.</p>
<p>Barycentric interpolation enables blending normals and colors by replacing the triangles' vertices with the associated vectors and RGB values. This technique produces smooth gradients and light shading in 3D graphics.</p>
<div class="highlight"><pre><span></span><code><span id="__span-14-1"><span class="sd">&quot;&quot;&quot; Barycentric Interpolation</span>
</span><span id="__span-14-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-14-3"><span class="k">def</span><span class="w"> </span><span class="nf">ToBarycentric</span><span class="p">(</span> <span class="n">triangle</span><span class="p">,</span> <span class="n">point</span> <span class="p">):</span>
</span><span id="__span-14-4">    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">triangle</span>
</span><span id="__span-14-5">    <span class="n">area</span> <span class="o">=</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span><span class="p">,</span> <span class="n">c</span> <span class="o">-</span> <span class="n">b</span> <span class="p">)</span><span class="o">.</span><span class="n">Length</span>
</span><span id="__span-14-6">    <span class="k">return</span> <span class="ne">Point3d</span><span class="p">(</span>
</span><span id="__span-14-7">        <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span> <span class="n">b</span> <span class="o">-</span> <span class="n">point</span><span class="p">,</span> <span class="n">c</span> <span class="o">-</span> <span class="n">b</span> <span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">/</span> <span class="n">area</span><span class="p">,</span>
</span><span id="__span-14-8">        <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span> <span class="n">c</span> <span class="o">-</span> <span class="n">point</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">c</span> <span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">/</span> <span class="n">area</span><span class="p">,</span>
</span><span id="__span-14-9">        <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span> <span class="n">a</span> <span class="o">-</span> <span class="n">point</span><span class="p">,</span> <span class="n">b</span> <span class="o">-</span> <span class="n">a</span> <span class="p">)</span><span class="o">.</span><span class="n">Length</span> <span class="o">/</span> <span class="n">area</span> <span class="p">)</span>
</span><span id="__span-14-10">
</span><span id="__span-14-11"><span class="k">def</span><span class="w"> </span><span class="nf">FromBarycentric</span><span class="p">(</span> <span class="n">triangle</span><span class="p">,</span> <span class="n">point</span> <span class="p">):</span>
</span><span id="__span-14-12">    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">triangle</span>
</span><span id="__span-14-13">    <span class="k">return</span> <span class="p">(</span> <span class="n">a</span> <span class="o">*</span> <span class="n">point</span><span class="o">.</span><span class="n">X</span> <span class="o">+</span>
</span><span id="__span-14-14">             <span class="n">b</span> <span class="o">*</span> <span class="n">point</span><span class="o">.</span><span class="n">Y</span> <span class="o">+</span>
</span><span id="__span-14-15">             <span class="n">c</span> <span class="o">*</span> <span class="n">point</span><span class="o">.</span><span class="n">Z</span> <span class="p">)</span>
</span></code></pre></div>
<h2 id="operations">Operations</h2>
<h3 id="surface-area">Surface Area</h3>
<p>The surface area of a mesh is computed by the sum of the areas of its triangles. The area of triangles can be computed using the cross product.</p>
<div class="highlight"><pre><span></span><code><span id="__span-15-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-15-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">):</span>
</span><span id="__span-15-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-15-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-15-5">
</span><span id="__span-15-6">    <span class="nd">@property</span>
</span><span id="__span-15-7">    <span class="k">def</span><span class="w"> </span><span class="nf">Triangles</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-15-8">        <span class="k">for</span> <span class="n">ia</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span><span class="p">:</span>
</span><span id="__span-15-9">            <span class="n">pa</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ia</span><span class="p">]</span>
</span><span id="__span-15-10">            <span class="n">pb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ib</span><span class="p">]</span>
</span><span id="__span-15-11">            <span class="n">pc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span><span class="p">[</span><span class="n">ic</span><span class="p">]</span>
</span><span id="__span-15-12">            <span class="k">yield</span> <span class="p">[</span><span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pc</span><span class="p">]</span>
</span><span id="__span-15-13">
</span><span id="__span-15-14">    <span class="nd">@property</span>
</span><span id="__span-15-15">    <span class="k">def</span><span class="w"> </span><span class="nf">Area</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-15-16">        <span class="n">area</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-15-17">        <span class="k">for</span> <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span><span class="p">:</span>
</span><span id="__span-15-18">            <span class="n">area</span> <span class="o">+=</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span>
</span><span id="__span-15-19">                <span class="n">pb</span> <span class="o">-</span> <span class="n">pa</span><span class="p">,</span> <span class="n">pc</span> <span class="o">-</span> <span class="n">pb</span> <span class="p">)</span><span class="o">.</span><span class="n">Length</span>
</span><span id="__span-15-20">        <span class="k">return</span> <span class="n">area</span> <span class="o">/</span> <span class="mi">2</span>
</span></code></pre></div>
<p>In Rhino the <code>AreaMassProperties</code> class may be used for computing mesh volumes.</p>
<div class="highlight"><pre><span></span><code><span id="__span-16-1"><span class="sd">&quot;&quot;&quot; Computing Mesh Areas</span>
</span><span id="__span-16-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-16-3"><span class="n">props</span> <span class="o">=</span> <span class="ne">AreaMassProperties</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span> <span class="n">mesh</span> <span class="p">)</span>
</span><span id="__span-16-4">
</span><span id="__span-16-5"><span class="nb">print</span><span class="p">(</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Area</span> <span class="p">)</span>
</span></code></pre></div>
<h3 id="mesh-volume">Mesh Volume</h3>
<p>Mesh volume is computed as the sum of signed volumes of tetrahedra formed by each triangle and the world origin, see <a href="https://doi.org/10.1109/ICIP.2001.958278">detailed</a> derivation. The volume associated with a triangle <code>[a, b, c]</code> and the world origin <code>o = [0, 0, 0]</code> is surprisingly easy to compute using <code>a  b  c</code>. Note that only properly closed meshes have meaningful volume.</p>
<div class="highlight"><pre><span></span><code><span id="__span-17-1"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-17-2">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">):</span>
</span><span id="__span-17-3">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-17-4">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-17-5">
</span><span id="__span-17-6">    <span class="nd">@property</span>
</span><span id="__span-17-7">    <span class="k">def</span><span class="w"> </span><span class="nf">Volume</span><span class="p">(</span> <span class="bp">self</span> <span class="p">):</span>
</span><span id="__span-17-8">        <span class="n">volume</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-17-9">        <span class="k">for</span> <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span><span class="p">,</span> <span class="n">pc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span><span class="p">:</span>
</span><span id="__span-17-10">            <span class="n">volume</span> <span class="o">+=</span> <span class="ne">Vector3d</span><span class="o">.</span><span class="n">CrossProduct</span><span class="p">(</span> <span class="n">pa</span><span class="p">,</span> <span class="n">pb</span> <span class="p">)</span> <span class="o">*</span> <span class="n">pc</span>
</span><span id="__span-17-11">        <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span> <span class="n">volume</span> <span class="o">/</span> <span class="mi">6</span> <span class="p">)</span>
</span></code></pre></div>
<p>In Rhino the <code>VolumeMassProperties</code> class may be used for computing mesh volumes.</p>
<div class="highlight"><pre><span></span><code><span id="__span-18-1"><span class="sd">&quot;&quot;&quot; Computing Mesh Volumes</span>
</span><span id="__span-18-2"><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-18-3"><span class="n">props</span> <span class="o">=</span> <span class="n">VolumeMassProperties</span><span class="o">.</span><span class="n">Create</span><span class="p">(</span> <span class="n">mesh</span> <span class="p">)</span>
</span><span id="__span-18-4">
</span><span id="__span-18-5"><span class="nb">print</span><span class="p">(</span> <span class="n">mesh</span><span class="o">.</span><span class="n">Volume</span> <span class="p">)</span>
</span></code></pre></div>
<h3 id="deduplication">Deduplication</h3>
<p>Removing duplicate mesh vertices or converting a triangle soup to an indexed mesh with shared vertices across faces is fairly complicated. This is because it requires finding all the unique or in other words shared vertices.</p>
<p>A simple approach is presented below, where an initially empty list of unique vertices and a list of faces is created. For each vertex from each triangle, first we look up whether the vertex exists or not in the unique vertex list. If the vertex exists, then we know its index, otherwise we append it at the end of the list and record the index as the length of unique vertices before insertion.</p>
<p>This algorithm is slow so it should not be used for large meshes.</p>
<div class="highlight"><pre><span></span><code><span id="__span-19-1"><span class="sd">&#39;&#39;&#39; Checks if a point existing in a list of points</span>
</span><span id="__span-19-2"><span class="sd">    Returns the index if present, or -1 otherwise.</span>
</span><span id="__span-19-3"><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-19-4"><span class="k">def</span><span class="w"> </span><span class="nf">FindPoint</span><span class="p">(</span> <span class="n">target</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="p">):</span>
</span><span id="__span-19-5">    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span> <span class="n">points</span> <span class="p">):</span>
</span><span id="__span-19-6">        <span class="k">if</span><span class="p">(</span> <span class="n">source</span><span class="o">.</span><span class="n">DistanceTo</span><span class="p">(</span> <span class="n">target</span> <span class="p">)</span> <span class="o">&lt;=</span> <span class="n">epsilon</span> <span class="p">):</span>
</span><span id="__span-19-7">            <span class="k">return</span> <span class="n">index</span>
</span><span id="__span-19-8">    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="__span-19-9">
</span><span id="__span-19-10"><span class="k">class</span><span class="w"> </span><span class="nc">IndexedMesh</span><span class="p">:</span>
</span><span id="__span-19-11">    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">):</span>
</span><span id="__span-19-12">        <span class="bp">self</span><span class="o">.</span><span class="n">Vertices</span> <span class="o">=</span> <span class="n">vertices</span>
</span><span id="__span-19-13">        <span class="bp">self</span><span class="o">.</span><span class="n">Faces</span>    <span class="o">=</span> <span class="n">faces</span>
</span><span id="__span-19-14">
</span><span id="__span-19-15"><span class="w">    </span><span class="sd">&#39;&#39;&#39; Removes duplicate vertices and returns a</span>
</span><span id="__span-19-16"><span class="sd">        new compacted mesh.</span>
</span><span id="__span-19-17"><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-19-18">    <span class="k">def</span><span class="w"> </span><span class="nf">RemoveDuplicateVertices</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="p">):</span>
</span><span id="__span-19-19">        <span class="n">vertices</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#-- Unique vertices list</span>
</span><span id="__span-19-20">        <span class="n">faces</span>    <span class="o">=</span> <span class="p">[]</span> <span class="c1">#-- Reindexed faces list</span>
</span><span id="__span-19-21">        <span class="k">for</span> <span class="n">triangle</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">Triangles</span><span class="p">:</span>
</span><span id="__span-19-22">            <span class="n">face</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-19-23">            <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="n">triangle</span><span class="p">:</span>
</span><span id="__span-19-24">                <span class="n">index</span> <span class="o">=</span> <span class="n">FindPoint</span><span class="p">(</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">vertices</span> <span class="p">)</span>
</span><span id="__span-19-25">                <span class="k">if</span><span class="p">(</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">):</span>
</span><span id="__span-19-26">                    <span class="n">index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span> <span class="n">vertices</span> <span class="p">)</span>
</span><span id="__span-19-27">                    <span class="n">vertices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">vertex</span> <span class="p">)</span>
</span><span id="__span-19-28">                <span class="n">face</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">index</span> <span class="p">)</span>
</span><span id="__span-19-29">            <span class="n">faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">face</span> <span class="p">)</span>
</span><span id="__span-19-30">        <span class="k">return</span> <span class="ne">IndexedMesh</span><span class="p">(</span> <span class="n">vertices</span><span class="p">,</span> <span class="n">faces</span> <span class="p">)</span>
</span></code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2024-2025 Digital Design and Fabrication
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.525ec568.min.js"></script>
      
    
  </body>
</html>